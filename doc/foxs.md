FoXS: fitting structures against SAXS data {#foxs}
==========================================

[TOC]

\tableofcontents

# Introduction {#foxsintro}

Nup133 is one of the proteins that make up the yeast
[Nuclear Pore Complex (NPC)](https://salilab.org/npc/). The structure of
this protein has been characterized by both X-ray crystallography and
small angle X-ray (SAXS).

%IMP includes a command line tool <tt>foxs</tt> for handling SAXS profiles,
which will be demonstrated in this example.
There is also a [web interface](https://salilab.org/foxs/) available,
which functions similarly.

For full help on the `foxs` tool, run from a command line:

\code{.sh}
foxs -h
\endcode

# Setup {#foxssetup}

First, download the input files used in this example, either by
[cloning the GitHub repository](https://github.com/salilab/foxs_tutorial/tree/master)
or by [downloading the zip file](https://github.com/salilab/foxs_tutorial/archive/master.zip).

All of the data for this example can be found in the `foxs/nup133`
subdirectory.

# Calculation {#foxscalc}

The structure of the C-terminal domain of yeast Nup133 is available in the
[RCSB Protein Data Bank (PDB)](http://www.pdb.org) as code
[3kfo](http://www.pdb.org/pdb/explore/explore.do?structureId=3KFO)
(file `3KFO.pdb`), while the experimental SAXS profile is given in the
`23922_merge.dat` file. The atomic structure can be fit against the
SAXS profile by running FoXS:

\code{.sh}
foxs 3KFO.pdb 23922_merge.dat
\endcode

FoXS calculates the theoretical profile of the 3KFO structure and fits it
against the experimental profile, and determines the quality of the fit, Chi,
with smaller values corresponding to closer fits. It also generates two
`.dat` files, one containing the theoretical profile and the other
this profile fit against the experimental profile. These files can be input to
a plotting package (two [gnuplot](http://www.gnuplot.info/) input
files with a `.plt` extension are provided).

The fit in this example is not a good one (Chi=2.96). To understand why this
is so, the header of the 3KFO PDB file can be examined in a text editor.
This reveals two problems. Several residues at the N and C termini were not
resolved in the X-ray experiment (9 in total, 2 at the N terminus and 7 at the
C terminus), and the sidechains of 16 other residues could also not be located
(REMARK 465 and REMARK 470 lines). This problem can be resolved by adding in
the missing atoms and residues by using
[MODELLER](https://salilab.org/modeller/), which generated the
<tt>3KFO-fill.B99990005.pdb</tt> file.

\note See `add-missing-residues.py` for the MODELLER script used. It simply
      builds a model of the full sequence of 3KFO using the partial sequence
      as a template (see the alignment file `alignment.ali`). Multiple models
      are generated; each is fit against the SAXS data using FoXS and the
      best-fitting model (`3KFO-fill.B99990005.pdb`) selected.

The fits of the original PDB and the new structure can now be generated by
running:

\code{.sh}
foxs -g 3KFO.pdb 3KFO-fill.B99990005.pdb 23922_merge.dat
\endcode

The output shows that the new structure has a significantly better fit
(Chi=1.15). FoXS generates a gnuplot input file `fit.plt` which will
plot the fits of all of the PDBs given against the profile. This can be
run with:

\code{.sh}
gnuplot fit.plt
\endcode

This generates an image, `fit.png`, showing the theoretical profiles
(lines in top panel), the experimental profile (points in top panel) and the
ratios of the experimental to theoretical profiles (bottom panel):

\image html foxs_nup133.png "FoXS plot of Nup133 and its SAXS profile" width=450px

For fitting multiple states against a SAXS profile, see the
[next section on MultiFoXS](@ref multifoxs).
